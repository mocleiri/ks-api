<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:search="http://student.kuali.org/xsd/search-extension"
	xmlns:dict="http://student.kuali.org/xsd/dictionary-extension"
	xsi:schemaLocation="
	http://student.kuali.org/xsd/search-extension http://student.kuali.org/xsd/search-extension/search-extension.xsd
	http://student.kuali.org/xsd/dictionary-extension http://student.kuali.org/xsd/dictionary-extension/dictionary-extension.xsd
	http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
	 ">
	 
	<import resource="lo-dictionary-config.xml" />
	
    <search:searchType id="lo.search.loByName">
        <search:name>LoSearchByName</search:name>
        <search:desc>Retrieve LO by name</search:desc>
        <search:searchResultTypeInfo>
            <ref bean="lo.result.los" />
        </search:searchResultTypeInfo>
		<search:searchCriteriaTypeInfo>
			<ref bean="lo.criteria.loName" />
		</search:searchCriteriaTypeInfo>
    </search:searchType>

    <search:searchType id="lo.search.los">
        <search:name>LO Search for all LOs</search:name>
        <search:desc>Returns all available LOs</search:desc>
        <search:searchResultTypeInfo>
            <ref bean="lo.result.los" />
        </search:searchResultTypeInfo>
        <search:searchCriteriaTypeInfo>
           <ref bean="lo.criteria.all"/>
        </search:searchCriteriaTypeInfo>
    </search:searchType>
    

    <search:searchCriteriaTypeInfo id="lo.criteria.all">
        <search:name>LoLo</search:name>
        <search:desc>Placeholder Criteria</search:desc>
    </search:searchCriteriaTypeInfo>
	
	<search:searchCriteriaTypeInfo id="lo.criteria.loName">
		<search:name>LoSearchByNameCriteria</search:name>
		<search:desc>Search criteria for searching for learning objectives by name</search:desc>
        <search:queryParams>
            <ref bean="lo.queryParam.loName" />
        </search:queryParams>
	</search:searchCriteriaTypeInfo>
	
    <search:queryParam id="lo.queryParam.loName">
        <dict:fieldDescriptor>
            <dict:name>Learning Objective Name</dict:name>
	        <dict:desc>Human-readable name for learning objective</dict:desc>
	        <dict:dataType>string</dict:dataType>
	        <dict:readOnly>true</dict:readOnly>
        </dict:fieldDescriptor>
    </search:queryParam>

    <search:searchResultTypeInfo id="lo.result.los">
        <search:name>Los</search:name>
        <search:desc>List Los</search:desc>
        <search:resultColumns>
            <ref bean="lo.resultColumn.loId" />
            <ref bean="lo.resultColumn.loName" />
        </search:resultColumns>
    </search:searchResultTypeInfo>

    <search:searchType id="lo.search.loByDesc">
        <search:name>LO Search for all LOs matching supplied word</search:name>
        <search:desc>Returns all matching LOs</search:desc>
        <search:searchResultTypeInfo>
            <ref bean="lo.result.loByDesc" />
        </search:searchResultTypeInfo>
        <search:searchCriteriaTypeInfo>
           <ref bean="lo.criteria.loByDesc"/>
        </search:searchCriteriaTypeInfo>
    </search:searchType>
 
    <search:searchResultTypeInfo id="lo.result.loByDesc">
        <search:name>Los</search:name>
        <search:desc>Lo descs</search:desc>
        <search:resultColumns>
            <ref bean="lo.resultColumn.loDescId" />
            <ref bean="lo.resultColumn.loDescPlain" />
        </search:resultColumns>
    </search:searchResultTypeInfo>
    
    <search:resultColumn id="lo.resultColumn.loId">
        <search:name>Lo Identifier</search:name>
        <search:desc>Identifier of an Lo</search:desc>
        <search:dataType>string</search:dataType>
    </search:resultColumn>

    <search:resultColumn id="lo.resultColumn.loName">
        <search:name>Lo Name</search:name>
        <search:desc>Official name of an Lo</search:desc>
        <search:dataType>string</search:dataType>
    </search:resultColumn>
    
    <search:resultColumn id="lo.resultColumn.loDescId">
        <search:name>Desc Identifier</search:name>
        <search:desc>Identifier of an LO desc </search:desc>
        <search:dataType>string</search:dataType>
    </search:resultColumn>

    <search:resultColumn id="lo.resultColumn.loDescPlain">
        <search:name>Lo Desc</search:name>
        <search:desc>Desc of an Lo</search:desc>
        <search:dataType>string</search:dataType>
    </search:resultColumn>
    
	<search:searchCriteriaTypeInfo id="lo.criteria.loByDesc">
		<search:name>LoByFirstLetterCriteria</search:name>
		<search:queryParams>
			<ref bean="lo.queryParam.loDescPlain" />
		</search:queryParams>
	</search:searchCriteriaTypeInfo>
	
    <search:queryParam id="lo.queryParam.loDescPlain">
        <dict:fieldDescriptor parent="parentFieldDescriptor">
            <dict:name>Description</dict:name>
        </dict:fieldDescriptor>
    </search:queryParam>
       
    <dict:fieldDescriptor id="parentFieldDescriptor">
        <dict:name>Comment Identifier</dict:name>
        <dict:desc>Unique identifier for a desc.</dict:desc>
        <dict:dataType>string</dict:dataType>
        <dict:readOnly>true</dict:readOnly>
    </dict:fieldDescriptor>
    
	<bean id="queryMap" class="org.springframework.beans.factory.config.MapFactoryBean">
		<property name="sourceMap">
			<map>
				<entry key="lo.search.los">
					<value>SELECT lo.id, lo.name FROM Lo lo </value>
				</entry>
				<entry key="lo.search.loByDesc">
                    <value>SELECT loDesc.plain FROM Lo lo JOIN lo.desc loDesc WHERE lower(loDesc.plain) like :lo_queryParam_loDescPlain</value>
				</entry>			
				<entry key="lo.search.loByName">
					<value>SELECT lo.id, lo.name FROM Lo lo WHERE lo.name = :lo_queryParam_loName</value>
				</entry>
            </map>
		</property>
	</bean>

</beans>
