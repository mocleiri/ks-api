<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:p="http://www.springframework.org/schema/p"
    xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:context="http://www.springframework.org/schema/context"
    xmlns:jee="http://www.springframework.org/schema/jee"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="
            http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd
            http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
            http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-2.5.xsd
            http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee-2.5.xsd
            http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd">

    <!-- Datasources
    <bean id="orgDataSource"
        class="com.atomikos.jdbc.AtomikosDataSourceBean" init-method="init"
        destroy-method="close">
        <property name="uniqueResourceName" value="orgDataSource" />
        <property name="xaDataSourceClassName"
            value="${jdbc.xaDataSourceClassName}" />
        <property name="xaProperties" value="${propertiesPrefix.org.jdbc.xaDataSourceProperties}"/>
        <property name="maxPoolSize" value="${jdbc.maxPoolSize}" />
    </bean>
-->
    <!-- JPA EntityManagerFactory
    <bean id="orgEntityManagerFactory"
        class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
        <property name="persistenceUnitName" value="Organization"/>
        <property name="jpaVendorAdapter">
            <bean class="${jpa.vendorAdapter}">
                <property name="databasePlatform"
                    value="${jpa.databasePlatform}" />
                <property name="showSql" value="${jpa.showSql}" />
                <property name="generateDdl" value="${jpa.generateDdl}" />
            </bean>
        </property>
        <property name="persistenceXmlLocation"
            value="classpath:META-INF/organization-persistence.xml" />
        <property name="dataSource" ref="orgDataSource" />
        <property name="jpaPropertyMap" value="${propertiesPrefix.jpa.properties}"/>
    </bean>
-->
    <!-- Organization Service Config
    <bean id="orgDao"
        class="org.kuali.student.core.organization.dao.impl.OrganizationDaoImpl">
    </bean>

    <bean id="orgServiceImpl"
        class="org.kuali.student.core.organization.service.impl.OrganizationServiceImpl">
        <property name="organizationDao" ref="orgDao" />
        <property name="searchManager" ref="orgSearchManager" />
        <property name="dictionaryServiceDelegate" ref="dictionaryServiceDelegate"/>
    </bean>

    <bean id="dictionaryServiceDelegate" 
        class="org.kuali.student.core.dictionary.service.impl.DictionaryServiceSpringImpl">
        <constructor-arg index="0" value="classpath:organization-dictionary-config.xml" />
    </bean>
    
    <bean id="orgSearchManager"
        class="org.kuali.student.core.search.service.impl.SearchManagerImpl"
        autowire="byType">
        <constructor-arg index="0" value="classpath:organization-search-config.xml" />
    </bean>
-->
    <!-- Preloaded data
    <bean id="dataLoadListener" class="org.kuali.student.common.util.jpa.LoadSqlListener">
        <property name="jtaTxManager" ref="JtaTxManager"/>
        <property name="preloadMap">
            <map>
                <entry key="Organization">
                    <value>classpath:ks-org.sql</value>
                </entry>
            </map>
        </property>
    </bean>
-->
    <!-- Rice Configuration --> 
    <bean id="riceConfig" class="org.kuali.rice.core.config.spring.ConfigFactoryBean">
        <property name="configLocations">
            <list>
                <value>classpath:rice-ksb-config.xml</value>
            </list>
        </property>
    </bean>

    <import resource="classpath:org/kuali/rice/core/RiceJTASpringBeans.xml"/>
    <import resource="classpath:org/kuali/rice/core/RiceDataSourceSpringBeans.xml"/>

    <bean id="rice" class="org.kuali.rice.core.config.RiceConfigurer">
        <property name="dataSource" ref="riceDataSource" />
        <property name="nonTransactionalDataSource" ref="riceNonTransactionalDataSource" />
        <property name="transactionManager" ref="jtaTransactionManager" />
        <property name="userTransaction" ref="jtaUserTransaction" />
        <property name="rootConfig" ref="riceConfig" />
        <property name="serviceNamespace" value="KS" />
        <property name="ksbConfigurer">
            <bean class="org.kuali.rice.ksb.messaging.config.KSBConfigurer">
                <property name="serviceServletUrl" value="${serviceServletUrl}" />
            </bean>
        </property>
    </bean>

    <bean class="org.kuali.rice.ksb.messaging.KSBExporter">
        <property name="serviceDefinition">     
            <bean class="org.kuali.rice.ksb.messaging.SOAPServiceDefinition">
                <property name="jaxWsService" value="true" />
                <property name="service" ref="orgServiceImpl" />
                <property name="serviceInterface" value="org.kuali.student.core.organization.service.OrganizationService" />
                <property name="localServiceName" value="OrgService" />
                <property name="serviceNameSpaceURI" value="http://org.kuali.student/core/organization" />
                <property name="busSecurity" value="false"></property>
            </bean>
        </property>
    </bean>

</beans>