<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
                           http://www.springframework.org/schema/beans/spring-beans.xsd">

    <bean id="KS-AcademicTerm-EditSection" parent="Uif-VerticalBoxSection">
        <property name="headerText" value="Terms" />
        <property name="cssClasses" value="ac_disclosure"/>
        <property name="header.style" value="margin-bottom:0"/>
        <property name="items">
            <list>
                <ref bean="KS-AcademicCalendar-Overview" />
                <ref bean="KS-AcademicTerm-EditSection-Main"/>
            </list>
        </property>
    </bean>

    <bean id="KS-AcademicTerm-EditSection-Main" parent="KS-Uif-StackedCollectionSection-VerticalSubCollectionFieldGroup">
        <property name="id" value="acal-term"/>
        <property name="readOnly" value="@{#view.readOnly}"/>
        <property name="propertyName" value="termWrapperList" />
        <property name="collectionObjectClass" value="org.kuali.student.enrollment.class2.acal.dto.AcademicTermWrapper" />
        <property name="style" value="min-width:70em;"/>
        <!--<property name="header.render" value="false" />-->
        <property name="headerText" value="Term/Subterm Detail"/>
        <property name="layoutManager.addLineGroup.header.render" value="false"/>

        <!-- Move the add button to the right of the fields -->
        <property name="layoutManager.addLineGroup.layoutManager.style" value="float:left;"/>
        <property name="layoutManager.addLineGroup.footer.style" value="display:inline-block;margin-top:2em;"/>

        <property name="layoutManager.lineGroupPrototype">
            <bean parent="Uif-CollectionVerticalBoxItem">
                <property name="disclosure.render" value="true"/>
                <property name="header">
                    <bean parent="Uif-HeaderFour"  p:headerText="@{#empty(#line.parentTerm) ? '' : 'Subterm: '}@{#line.termNameForUI}">
                        <property name="rightGroup">
                            <bean parent="Uif-HorizontalBoxGroup">
                                <!-- Rice Issue Workaround Watch KSENROLL-7408 -->
                                <property name="items">
                                    <list>
                                        <bean parent="Uif-HorizontalBoxGroup">
                                            <property name="render" value="@{#line.termInfo != null and #line.termInfo.id != null }"/>
                                            <property name="items">
                                                <list>
                                                    <bean parent="KS-Lozenge-Green-Uif-Message" p:messageText="Official" p:render="@{#line.official}"/>
                                                    <bean parent="KS-Lozenge-Grey-Uif-Message" p:messageText="Draft" p:render="@{!#line.official}"/>
                                                    <bean id="term_official" parent="Uif-ActionLink" p:methodToCall="makeTermOfficial" p:actionLabel="Make Official"
                                                          p:render="@{!#line.official}"
                                                          p:onClickScript="writeHiddenToForm(&quot;actionParameters[selectedLineIndex]&quot;, &quot;@{#index}&quot;);"  />
                                                    <bean parent="Uif-ActionLink" p:methodToCall="deleteTerm" p:actionLabel="Delete Term Draft"
                                                          p:onClickScript="writeHiddenToForm(&quot;actionParameters[selectedLineIndex]&quot;, &quot;@{#index}&quot;);"
                                                          p:render="@{!#line.official}"/>
                                                </list>
                                            </property>
                                        </bean>
                                        <bean id="term_cancel_button" parent="Uif-ActionLink"
                                              p:methodToCall="cancelTerm" p:actionLabel="Cancel"
                                              p:render="@{#line.termInfo == null or #line.termInfo.id == null }"
                                              p:onClickScript="writeHiddenToForm(&quot;actionParameters[selectedLineIndex]&quot;, &quot;@{#index}&quot;);"/>
                                    </list>
                                </property>
                            </bean>
                        </property>
                    </bean>
                </property>
            </bean>
        </property>
        <property name="addLineActions">
            <list>
                <!-- Needed to prevent focus from moving to first line and re-validating, which always will cause an error
                 since the first field is a validated dropdown -->
                <bean parent="Uif-AddLineAction" p:focusOnIdAfterSubmit="SELF"/>
            </list>
        </property>

        <property name="addLineItems">
            <list>
                <bean id="term_type_add" parent="Uif-InputField-LabelTop" p:propertyName="termType" p:render="@{#isAddLine}"
                      p:label="Term Type" p:required="true">
                    <property name="control">
                        <bean parent="Uif-DropdownControl"/>
                    </property>
                    <property name="optionsFinder">
                        <bean class="org.kuali.student.enrollment.class2.acal.keyvalue.AcademicTermTypeKeyValues" p:addBlankOption="false"/>
                    </property>
                </bean>
                <bean id="term_start_date_add" parent="Uif-InputField-LabelTop" p:propertyName="startDate" p:label="Start Date" p:required="true">
                    <property name="control">
                        <bean parent="Uif-KS-Default-DateControl" p:size="9" p:watermarkText="mm/dd/yyyy"/>
                    </property>
                    <property name="validCharactersConstraint">
                        <bean parent="BasicDatePatternConstraint" />
                    </property>
                    <property name="attributeQuery">
                        <bean parent="Uif-AttributeQueryConfig">
                            <property name="queryMethodToCall" value="termInfoAjaxQuery"/>
                            <property name="queryMethodArgumentFieldList">
                                <list>
                                    <value>startDate</value>
                                    <value>termType</value>
                                </list>
                            </property>
                            <property name="queryFieldMapping" value="{startDate:startDate,termType:termType}"/>
                            <property name="returnFieldMapping" value="termCode:termCode"/>
                        </bean>
                    </property>
                </bean>
                <bean id="term_end_date_add" parent="Uif-InputField-LabelTop" p:propertyName="endDate" p:label="End Date" p:required="true">
                    <property name="control">
                        <bean parent="Uif-KS-Default-DateControl" p:size="9" p:watermarkText="mm/dd/yyyy"/>
                    </property>
                    <property name="validCharactersConstraint">
                        <bean parent="BasicDatePatternConstraint" />
                    </property>
                </bean>
                <bean id="parent_term_type" parent="Uif-InputField-LabelTop" p:propertyName="parentTerm" p:render="@{#isAddLine}" p:label="Parent Term" p:refreshWhenChangedPropertyNames="#lp.termType">
                    <property name="control">
                        <bean parent="Uif-DropdownControl"/>
                    </property>
                    <property name="optionsFinder">
                        <bean class="org.kuali.student.enrollment.class2.acal.keyvalue.AcademicTermParentTypeKeyValues" p:addBlankOption="false"/>
                    </property>
                    <!--<property name="attributeQuery">-->
                        <!--<bean parent="Uif-AttributeQueryConfig">-->
                            <!--<property name="queryMethodToCall" value="termInfoAjaxQuery"/>-->
                            <!--<property name="queryMethodArgumentFieldList">-->
                                <!--<list>-->
                                    <!--<value>startDate</value>-->
                                    <!--<value>termType</value>-->
                                <!--</list>-->
                            <!--</property>-->
                            <!--<property name="queryFieldMapping" value="{startDate:startDate,termType:termType}"/>-->
                            <!--<property name="returnFieldMapping" value="termCode:termCode"/>-->
                        <!--</bean>-->
                    <!--</property>-->
                </bean>
            </list>
        </property>
        <property name="items">
            <list>
                <bean parent="Uif-VerticalFieldGroup" p:fieldLabel.render="false">
                    <property name="items">
                        <list>
                            <bean parent="Uif-HorizontalBoxGroup">
                                <property name="items">
                                    <list>
                                        <bean id="term_type" parent="Uif-InputField-LabelTop" p:propertyName="termType" p:render="@{#isAddLine}"
                                              p:label="Term Type" p:required="true">
                                            <property name="control">
                                                <bean parent="Uif-DropdownControl"/>
                                            </property>
                                            <property name="optionsFinder">
                                                <bean class="org.kuali.student.enrollment.class2.acal.keyvalue.AcademicTermTypeKeyValues" p:addBlankOption="false"/>
                                            </property>
                                            <property name="attributeQuery">
                                                <bean parent="Uif-AttributeQueryConfig">
                                                    <property name="queryMethodToCall" value="termInfoAjaxQuery"/>
                                                    <property name="queryMethodArgumentFieldList">
                                                        <list>
                                                            <value>startDate</value>
                                                            <value>termType</value>
                                                        </list>
                                                    </property>
                                                    <property name="queryFieldMapping" value="{startDate:startDate,termType:termType}"/>
                                                    <property name="returnFieldMapping" value="termCode:termCode"/>
                                                </bean>
                                            </property>
                                        </bean>
                                        <bean id="term_name" parent="Uif-InputField-LabelTop" p:propertyName="name" p:render="@{!#isAddLine}" p:label="Name" p:required="true">
                                            <property name="control">
                                                <bean parent="Uif-TextControl" p:size="30" />
                                            </property>
                                        </bean>
                                        <bean id="term_code" parent="Uif-InputField-LabelTop" p:propertyName="termCode" p:label="Term Code" p:render="@{#line.termCode != T(org.kuali.student.enrollment.class2.acal.util.CalendarConstants).EMPTY_TERM_CODE}">
                                            <property name="control">
                                                <bean parent="Uif-TextControl" p:disabled="true" p:size="9">
                                                    <property name="cssClasses">
                                                        <list>
                                                            <value>acal_term_code</value>
                                                        </list>
                                                    </property>
                                                </bean>
                                            </property>
                                        </bean>
                                    </list>
                                </property>
                            </bean>
                            <bean parent="Uif-HorizontalBoxGroup">
                                <property name="items">
                                    <list>
                                        <bean id="term_start_date" parent="Uif-InputField-LabelTop" p:propertyName="startDate" p:label="Start Date" p:required="true">
                                            <property name="control">
                                                <bean parent="Uif-KS-Default-DateControl" p:size="9" p:watermarkText="mm/dd/yyyy"/>
                                            </property>
                                            <property name="validCharactersConstraint">
                                                <bean parent="BasicDatePatternConstraint" />
                                            </property>
                                            <property name="attributeQuery">
                                                <bean parent="Uif-AttributeQueryConfig">
                                                    <property name="queryMethodToCall" value="termInfoAjaxQuery"/>
                                                    <property name="queryMethodArgumentFieldList">
                                                        <list>
                                                            <value>startDate</value>
                                                            <value>termType</value>
                                                        </list>
                                                    </property>
                                                    <property name="queryFieldMapping" value="{startDate:startDate,termType:termType}"/>
                                                    <property name="returnFieldMapping" value="termCode:termCode"/>
                                                </bean>
                                            </property>
                                        </bean>
                                        <bean id="term_end_date" parent="Uif-InputField-LabelTop" p:propertyName="endDate" p:label="End Date" p:required="true">
                                            <property name="control">
                                                <bean parent="Uif-KS-Default-DateControl" p:size="9" p:watermarkText="mm/dd/yyyy"/>
                                            </property>
                                            <property name="validCharactersConstraint">
                                                <bean parent="BasicDatePatternConstraint" />
                                            </property>
                                        </bean>
                                        <bean id="term_instructional_days" parent="Uif-InputField-LabelTop" p:propertyName="instructionalDays" p:label="Instructional Days" p:render="@{!#isAddLine}" p:readOnly="true" p:style="width:11em;">
                                            <property name="toolTip">
                                                <bean parent="Uif-TooltipFocus" p:onMouseHover="true" p:tooltipContent="Instructional Days include @{#lp.instructionalDayConfig}"/>
                                            </property>
                                        </bean>
                                    </list>
                                </property>
                            </bean>
                            <bean parent="Uif-InputField" p:propertyName="termType" p:render="@{!#isAddLine}" p:hidden="true">
                                <property name="control">
                                    <bean parent="Uif-HiddenControl"/>
                                </property>
                            </bean>
                        </list>
                    </property>
                </bean>
            </list>
        </property>
        <property name="subCollections">
            <list>
                <ref bean="KS-KeyDatesGroup-EditSubSection" />
            </list>
        </property>
    </bean>

    <bean id="KS-KeyDatesGroup-EditSubSection" parent="KS-Uif-StackedCollectionSubSection-HorizontalSubCollectionFieldGroupWithDisclosure"
          p:onDocumentReadyScript="highlightElements(@{validationJSONString}, @{addLineValid}, '@{#ConfigProperties['application.url']}');">
        <property name="id" value="acal-term-keydatesgroup"/>
        <property name="readOnly" value="@{#view.readOnly}"/>
        <property name="propertyName" value="keyDatesGroupWrappers" />
        <property name="collectionObjectClass" value="org.kuali.student.enrollment.class2.acal.dto.KeyDatesGroupWrapper" />
        <property name="headerText" value="Key Dates" />
        <property name="header.render" value="@{!#view.readOnly}"/>

        <!-- Move the add button to the right of the fields -->
        <property name="layoutManager.addLineGroup.layoutManager.style" value="float:left;"/>
        <property name="layoutManager.addLineGroup.footer.style" value="display:inline-block;margin-top:0.2em;"/>

        <property name="layoutManager.addLineGroup.header.render" value="false"/>
        <property name="layoutManager.lineGroupPrototype.validationMessages.displayMessages" value="false"/>
        <property name="layoutManager.lineGroupPrototype.header.headerText" value="@{#line.keyDateGroupNameUI} Key Dates"/>
        <property name="layoutManager.lineGroupPrototype.header.cssClasses">
            <list merge="true">
                <value>ks-borderBottom3</value>
            </list>
        </property>
        <property name="addLineActions">
            <list>
                <!-- Needed to prevent focus from moving to first line and re-validating, which always will cause an error
                since the first field is a validated dropdown -->
                <bean parent="Uif-AddLineAction" p:focusOnIdAfterSubmit="SELF"/>
            </list>
        </property>
        <property name="lineActions">
            <list>
                <bean id="key_date_group_delete_button" parent="Uif-SecondaryActionButton-Small" p:methodToCall="deleteKeyDateGroup" p:actionLabel="delete keydate group"/>
            </list>
        </property>
        <property name="items">
            <list>
                <bean id="key_date_group_type" parent="Uif-InputField" p:propertyName="keyDateGroupType" p:render="@{#isAddLine}"
                      p:label="* Key Date Group Type"
                      p:finalizeMethodToCall="populateKeyDateGroupTypes" > <!--p:required="true"-->
                    <property name="control">
                        <bean parent="Uif-DropdownControl"/>
                    </property>
                    <property name="optionsFinder">
                        <bean class="org.kuali.student.enrollment.class2.courseoffering.keyvalue.DummyKeyValue"/>
                    </property>
                </bean>
            </list>
        </property>
        <property name="subCollections">
            <list>
                <ref bean="KS-KeyDates-EditSubSection" />
            </list>
        </property>
    </bean>

    <bean id="KS-KeyDates-EditSubSection" parent="Uif-Disclosure-TableSubCollection-WithinSubSection"
          p:id="acal-term-keydates" p:readOnly="@{#view.readOnly}" p:onDocumentReadyScript="highlightElements(@{validationJSONString}, @{addLineValid}, '@{#ConfigProperties['application.url']}');">
        <property name="propertyName" value="keydates" />
        <property name="collectionObjectClass" value="org.kuali.student.enrollment.class2.acal.dto.KeyDateWrapper" />
        <property name="header.render" value="false"/>
        <!--<property name="layoutManager.numberOfColumns" value="@{#view.readOnly ? 3 : 9}"/>-->
        <property name="layoutManager.style" value="width:100%;"/>
        <property name="layoutManager.applyDefaultCellWidths" value="false" />
        <property name="layoutManager.applyAlternatingRowStyles" value="false" />
        <!--<property name="validationMessages.displayMessages" value="false"/>-->
        <property name="layoutManager.addLineGroup.layoutManager.applyDefaultCellWidths" value="false"/>
        <property name="layoutManager.cssClasses">
            <list merge="true">
                <value>ks-tablecollection-table</value>
            </list>
        </property>
        <property name="layoutManager.renderSequenceField" value="false" />
        <property name="layoutManager.generateAutoSequence" value="false" />
        <property name="layoutManager.separateAddLine" value="false" />
        <property name="layoutManager.richTable.disableTableSort" value="true" />
        <property name="layoutManager.richTable.render" value="false" />
        <property name="addLineActions">
            <list>
                <!-- Needed to prevent focus from moving to first line and re-validating, which always will cause an error
                since the first field is a validated dropdown -->
                <bean parent="Uif-AddLineAction" p:focusOnIdAfterSubmit="SELF"/>
            </list>
        </property>
        <property name="items">
            <list>
                <bean id="key_date_type" parent="Uif-InputField" p:propertyName="keyDateType"
                      p:readOnly="@{!#isAddLine}" p:readOnlyDisplayReplacementPropertyName="keyDateNameUI"
                      p:label="* Key Date Type"
                      p:finalizeMethodToCall="populateKeyDateTypes" p:style="font-weight:bold;"> <!--p:required="true"-->
                    <property name="control">
                        <bean parent="Uif-DropdownControl"/>
                    </property>
                    <property name="optionsFinder">
                        <bean class="org.kuali.student.enrollment.class2.courseoffering.keyvalue.DummyKeyValue"/>
                    </property>
                </bean>
                <bean id="key_date_start_date" parent="Uif-InputField" p:propertyName="startDate" p:readOnlyDisplayReplacementPropertyName="startDateUI"
                      p:label="* Start Date" >   <!--p:required="true"-->
                    <property name="control">
                        <bean parent="Uif-KS-Default-DateControl" p:size="9" p:watermarkText="mm/dd/yyyy"/>
                    </property>
                    <property name="validCharactersConstraint">
                        <bean parent="BasicDatePatternConstraint" />
                    </property>
                </bean>
                <bean id="key_date_start_time" parent="Uif-InputField" p:propertyName="startTime" p:render="@{!#view.readOnly}"
                      p:label="Start Time">
                    <property name="control">
                        <bean parent="Uif-TextControl" p:size="4" p:watermarkText="hh:mm">
                            <property name="disabled" value="@{#lp.allDay}"/>
                        </bean>
                    </property>
                    <property name="validCharactersConstraint">
                        <bean parent="TimePatternConstraint" />
                    </property>
                </bean>
                <bean id="key_date_start_time_ampm" parent="Uif-InputField" p:propertyName="startTimeAmPm" p:render="@{!#view.readOnly}"
                      p:required="@{!#lp.allDay and !#empty(#lp.startTime)}"
                      p:refreshWhenChangedPropertyNames="#lp.startTime">
                    <property name="control">
                        <bean parent="Uif-DropdownControl" p:options-ref="hctime-options">
                            <property name="disabled" value="@{#lp.allDay or #empty(#lp.startTime)}"/>
                        </bean>
                    </property>
                </bean>
                <bean id="key_date_end_date" parent="Uif-InputField" p:propertyName="endDate" p:render="@{!#view.readOnly}"
                      p:label="End Date" p:required="@{#lp.dateRange and !#isAddLine}"
                      p:refreshWhenChangedPropertyNames="#lp.dateRange">
                    <property name="control">
                        <bean parent="Uif-KS-Default-DateControl" p:size="9" p:watermarkText="mm/dd/yyyy">
                            <property name="disabled" value="@{!#lp.dateRange}"/>
                        </bean>
                    </property>
                    <property name="validCharactersConstraint">
                        <bean parent="BasicDatePatternConstraint" />
                    </property>
                </bean>
                <bean parent="Uif-DataField" p:propertyName="endDateUI" p:render="@{#view.readOnly}" p:label="End Date"/>
                <bean id="key_date_end_time" parent="Uif-InputField" p:propertyName="endTime" p:render="@{!#view.readOnly}"
                      p:label="End Time">
                    <property name="control">
                        <bean parent="Uif-TextControl" p:size="4" p:watermarkText="hh:mm">
                            <property name="disabled" value="@{#lp.allDay}"/>
                        </bean>
                    </property>
                    <property name="validCharactersConstraint">
                        <bean parent="TimePatternConstraint" />
                    </property>
                </bean>
                <bean id="key_date_end_time_ampm" parent="Uif-InputField" p:propertyName="endTimeAmPm" p:render="@{!#view.readOnly}"
                      p:required="@{!#lp.allDay and !#empty(#lp.endTime)}"
                      p:refreshWhenChangedPropertyNames="#lp.endTime">
                    <property name="control">
                        <bean parent="Uif-DropdownControl" p:options-ref="hctime-options">
                            <property name="disabled" value="@{#lp.allDay or #empty(#lp.endTime)}"/>
                        </bean>
                    </property>
                </bean>
                <bean id="key_date_all_day" parent="Uif-InputField" p:propertyName="allDay" p:label="All Day" p:render="@{!#view.readOnly}">
                    <property name="control">
                        <bean parent="Uif-CheckboxControl"/>
                    </property>
                </bean>
                <bean id="key_date_range" parent="Uif-InputField" p:propertyName="dateRange" p:label="Date Range" p:render="@{!#view.readOnly}">
                    <property name="control">
                        <bean parent="Uif-CheckboxControl" />
                    </property>
                </bean>
            </list>
        </property>
        <property name="lineActions">
            <list>
                <bean id="key_date_delete_button" parent="Uif-PrimaryActionButton-Small" p:methodToCall="deleteKeyDate" p:actionLabel="delete"/>
            </list>
        </property>
    </bean>
    <bean id="textAligns" class="org.kuali.rice.krad.uif.CssConstants.TextAligns"/>
</beans>
