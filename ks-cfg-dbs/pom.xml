<project xmlns="http://maven.apache.org/POM/4.0.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
    <modelVersion>4.0.0</modelVersion>
    <parent>
        <groupId>org.kuali.student.deployments</groupId>
        <artifactId>ks-deployments</artifactId>
        <version>2.0.0-SNAPSHOT</version>
    </parent>
    <groupId>org.kuali.student.db</groupId>
    <artifactId>ks-cfg-dbs</artifactId>
    <version>2.0.0-SNAPSHOT</version>
    <packaging>pom</packaging>
    <name>KS DB Config</name>
    <description>Kuali Student Impex</description>
    <modules>
        <module>ks-rice-db</module>
        <module>ks-bundled-db</module>
        <module>ks-app-db</module>
    </modules>
    <properties>
        <!-- All impex configurations need to have Ant compatibility mode -->
        <impex.antCompatibilityMode>true</impex.antCompatibilityMode>
        <!-- Impex properties with the prefix 'impex.xml' are used in the xml generation step of impex -->
        <impex.xml.password>KSMASTER_20</impex.xml.password>
        <impex.xml.username>KSMASTER_20</impex.xml.username>
        <impex.xml.schema>KSMASTER_20</impex.xml.schema>
        <impex.xml.oracle.url>jdbc:oracle:thin:@localhost:1521:XE</impex.xml.oracle.url>
        <impex.xml.mysql.url>jdbc:mysql://localhost</impex.xml.mysql.url>
        <!-- 
      The sql generation step of impex requires the schema file generated by impex to be in this location 
      and all the xml files are expected in src/main/resources, rather than the default of src/main/impex
    -->
        <impex.xml.schemaXMLFile>${project.basedir}/src/main/resources/schema.xml</impex.xml.schemaXMLFile>
        <impex.dataXMLDir>${project.basedir}/src/main/resources</impex.dataXMLDir>
        <!-- Impex properties with the prefix 'impex.sql' are used in the sql generation step of impex -->
        <impex.sql.basedir>${project.basedir}</impex.sql.basedir>
        <impex.sql.schema.name>${project.artifactId}</impex.sql.schema.name>
        <impex.sql.mvn.sql>${project.basedir}/src/main/resources/impex/sql</impex.sql.mvn.sql>
        <!-- Override the paths for the meta-inf plugin to capture the generated sql locations -->
        <sql.meta.input.base>${project.basedir}/src/main/resources</sql.meta.input.base>
        <sql.schema.include>impex/sql/${db.vendor}/${project.artifactId}.sql</sql.schema.include>
        <sql.data.include>impex/sql/${db.vendor}/K*.sql</sql.data.include>
        <sql.constraints.include>impex/sql/${db.vendor}/${project.artifactId}-constraints.sql</sql.constraints.include>
    </properties>
    <build>
        <pluginManagement>
            <plugins>
                <plugin>
                    <groupId>org.kuali.maven.plugins</groupId>
                    <artifactId>spring-maven-plugin</artifactId>
                    <executions>
                        <execution>
                            <id>load</id>
                            <phase>initialize</phase>
                            <goals>
                                <goal>load</goal>
                            </goals>
                            <configuration>
                                <location>classpath:org/kuali/common/deploy/spring/db-developer-context.xml</location>
                                <propertiesBeanName>deploy.mavenProperties</propertiesBeanName>
                            </configuration>
                        </execution>
                    </executions>
                    <dependencies>
                        <dependency>
                            <groupId>org.kuali.student.core</groupId>
                            <artifactId>ks-core-sql</artifactId>
                            <version>${ks.core.version}</version>
                        </dependency>
                        <dependency>
                            <groupId>org.kuali.student.core</groupId>
                            <artifactId>ks-rice-sql</artifactId>
                            <version>${ks.core.version}</version>
                        </dependency>
                        <dependency>
                            <groupId>org.kuali.student.lum</groupId>
                            <artifactId>ks-lum-sql</artifactId>
                            <version>${ks.lum.version}</version>
                        </dependency>
                        <dependency>
                            <groupId>org.kuali.student.enroll</groupId>
                            <artifactId>ks-enroll-sql</artifactId>
                            <version>${ks.enroll.version}</version>
                        </dependency>
                        <dependency>
                            <groupId>org.kuali.common</groupId>
                            <artifactId>kuali-deploy</artifactId>
                            <version>${kuali-deploy.version}</version>
                        </dependency>
                        <dependency>
                            <groupId>org.kuali.common</groupId>
                            <artifactId>kuali-jdbc</artifactId>
                            <version>${kuali.jdbc.version}</version>
                        </dependency>
                        <dependency>
                            <groupId>org.kuali.common</groupId>
                            <artifactId>kuali-util</artifactId>
                            <version>${kuali.util.version}</version>
                        </dependency>
                        <dependency>
                            <groupId>org.kuali.rice</groupId>
                            <artifactId>rice-impex-server-bootstrap</artifactId>
                            <version>${kuali.rice.version}</version>
                            <classifier>sql</classifier>
                        </dependency>
                        <dependency>
                            <groupId>mysql</groupId>
                            <artifactId>mysql-connector-java</artifactId>
                            <version>${mysql.version}</version>
                        </dependency>
                        <dependency>
                            <groupId>com.oracle</groupId>
                            <artifactId>${oracle.artifact}</artifactId>
                            <version>${oracle.version}</version>
                        </dependency>
                        <dependency>
                            <groupId>org.kuali.student.deployments</groupId>
                            <artifactId>ks-deployment-resources</artifactId>
                            <version>${project.parent.version}</version>
                        </dependency>
                    </dependencies>
                </plugin>
                <plugin>
                    <groupId>org.kuali.maven.plugins</groupId>
                    <artifactId>maven-impex-plugin</artifactId>
                    <version>${plugin.impex.version}</version>
                    <dependencies>
                        <dependency>
                            <groupId>mysql</groupId>
                            <artifactId>mysql-connector-java</artifactId>
                            <version>${mysql.version}</version>
                        </dependency>
                        <dependency>
                            <groupId>com.oracle</groupId>
                            <artifactId>${oracle.artifact}</artifactId>
                            <version>${oracle.version}</version>
                        </dependency>
                    </dependencies>
                    <configuration>
                        <username>${impex.xml.username}</username>
                        <password>${impex.xml.password}</password>
                        <url>${impex.xml.url}</url>
                        <schema>${impex.xml.schema}</schema>
                        <schemaXMLFile>${impex.xml.schemaXMLFile}</schemaXMLFile>
                        <dataXMLDir>${impex.dataXMLDir}</dataXMLDir>
                        <outputDir>${project.build.directory}/impex/</outputDir>
                        <antCompatibilityMode>${impex.antCompatibilityMode}</antCompatibilityMode>
                        <includes>${impex.xml.includedTables}</includes>
                        <excludes>${impex.xml.excludedTables}</excludes>
                    </configuration>
                    <executions>
                        <execution>
                            <id>exportXML</id>
                            <goals>
                                <goal>exportschema</goal>
                                <goal>exportdata</goal>
                                <goal>datadtd</goal>
                            </goals>
                        </execution>
                    </executions>
                </plugin>
                <plugin>
                    <groupId>org.kuali.maven.plugins</groupId>
                    <artifactId>mvn-maven-plugin</artifactId>
                    <version>${plugin.mvn.version}</version>
                    <executions>
                        <execution>
                            <id>sql</id>
                            <phase>process-resources</phase>
                            <goals>
                                <goal>mvn</goal>
                            </goals>
                            <configuration>
                                <args>
                                    <arg>process-resources</arg>
                                    <arg>-e</arg>
                                    <arg>-DantCompatibilityMode=${impex.antCompatibilityMode}</arg>
                                </args>
                                <poms>
                                    <param>classpath:org/kuali/common/deploy/mvn/impex-with-sql.xml</param>
                                </poms>
                                <properties>
                                    <property>impex.sql.basedir</property>
                                    <property>impex.sql.schema.name</property>
                                    <property>plugin.impex.version</property>
                                    <property>impex.sql.mvn.sql</property>
                                </properties>
                            </configuration>
                        </execution>
                    </executions>
                    <dependencies>
                        <dependency>
                            <groupId>org.kuali.common</groupId>
                            <artifactId>kuali-deploy</artifactId>
                            <version>${kuali.deploy.version}</version>
                        </dependency>
                    </dependencies>
                </plugin>
            </plugins>
        </pluginManagement>
    </build>
    <profiles>
        <profile>
            <id>build-master-db</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.kuali.maven.plugins</groupId>
                        <artifactId>spring-maven-plugin</artifactId>
                    </plugin>
                </plugins>
            </build>
        </profile>
        <profile>
            <id>oracle</id>
            <properties>
                <db.vendor>oracle</db.vendor>
                <impex.xml.url>${impex.xml.oracle.url}</impex.xml.url>
            </properties>
        </profile>
        <profile>
            <id>mysql</id>
            <properties>
                <db.vendor>mysql</db.vendor>
                <impex.xml.url>${impex.xml.mysql.url}</impex.xml.url>
            </properties>
        </profile>
        <profile>
            <id>meta-inf</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.kuali.maven.plugins</groupId>
                        <artifactId>metainf-maven-plugin</artifactId>
                    </plugin>
                </plugins>
            </build>
        </profile>
    </profiles>
</project>
