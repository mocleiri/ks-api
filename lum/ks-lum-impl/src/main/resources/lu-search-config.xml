<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:search="http://student.kuali.org/xsd/search-extension"
	xmlns:dict="http://student.kuali.org/xsd/dictionary-extension"
	xsi:schemaLocation="
	http://student.kuali.org/xsd/search-extension http://student.kuali.org/xsd/search-extension/search-extension.xsd
	http://student.kuali.org/xsd/dictionary-extension http://student.kuali.org/xsd/dictionary-extension/dictionary-extension.xsd
	http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
	 ">
	<import resource="lu-dictionary-config.xml" />

	<!-- definition for generic search component -->
	<search:searchType id="lu.search.generic">
		<search:name>Basic and Advanced Search</search:name>
		<search:desc>Query with multiple optional elements to satisfy most advanced pickers</search:desc>
		<search:searchResultTypeInfo>  <!--  could be defined as stand alone -->
			<search:name>Lu Full View</search:name>
			<search:desc>Full view of clus</search:desc>
			<search:resultColumns>
				<ref bean="lu.resultColumn.cluId" /> 
				<search:resultColumn id="lu.resultColumn.luOptionalLongName">
					<search:name>Name</search:name>
					<search:desc>Long name for the lu, recorded as the default listing.</search:desc>
					<search:dataType>string</search:dataType>
				</search:resultColumn>
				<search:resultColumn id="lu.resultColumn.luOptionalCode">
					<search:name>Code</search:name>
					<search:desc>Lu code</search:desc>
					<search:dataType>string</search:dataType>
				</search:resultColumn>	
				<search:resultColumn id="lu.resultColumn.luOptionalLevel">
					<search:name>Level</search:name>
					<search:desc>Level of Lu</search:desc>
					<search:dataType>string</search:dataType>
				</search:resultColumn>							
			</search:resultColumns>
		</search:searchResultTypeInfo>
		<search:searchCriteriaTypeInfo id="lu.criteria.luAdvancedCriteria">
			<search:name>LuAdvancedCriteria</search:name>
			<search:desc>Advanced criteria</search:desc>
			<search:queryParams>
				<search:queryParam id="lu.queryParam.luOptionalId" optional="true">
					<dict:fieldDescriptor> 
						<dict:name>Id</dict:name>
						<dict:desc>Unique identifier for a lu.</dict:desc>
						<dict:dataType>string</dict:dataType>
						<dict:readOnly>true</dict:readOnly>
					</dict:fieldDescriptor>
				</search:queryParam>			
				<search:queryParam id="lu.queryParam.luOptionalLongName" optional="true">
					<dict:fieldDescriptor>
						<dict:name>Name</dict:name>
						<dict:desc>Long name.</dict:desc>
						<dict:dataType>string</dict:dataType>
						<dict:readOnly>true</dict:readOnly>
					</dict:fieldDescriptor>
				</search:queryParam>	
				<search:queryParam id="lu.queryParam.luOptionalType" optional="true">
					<dict:fieldDescriptor>
						<dict:name>Type</dict:name>
						<dict:desc>Lu type (course, program etc.)</dict:desc>
						<dict:dataType>string</dict:dataType>
						<dict:readOnly>true</dict:readOnly>
					</dict:fieldDescriptor>
				</search:queryParam>	
				<search:queryParam id="lu.queryParam.luOptionalCode" optional="true">
					<dict:fieldDescriptor>
						<dict:name>Code</dict:name>
						<dict:desc>Lu code</dict:desc>
						<dict:dataType>string</dict:dataType>
						<dict:readOnly>true</dict:readOnly>
					</dict:fieldDescriptor>
				</search:queryParam>
				<search:queryParam id="lu.queryParam.luOptionalLevel" optional="true">
					<dict:fieldDescriptor>
						<dict:name>Level</dict:name>
						<dict:desc>Lu type (course, program etc.)</dict:desc>
						<dict:dataType>string</dict:dataType>
						<dict:readOnly>true</dict:readOnly>
					</dict:fieldDescriptor>
				</search:queryParam>															
			</search:queryParams>
		</search:searchCriteriaTypeInfo>
	</search:searchType>

    <search:searchType id="lu.search.clus">
        <search:name>Lum Search for Clus</search:name>
        <search:desc>Returns all available Clus</search:desc>
        <search:searchResultTypeInfo>
            <ref bean="lu.result.luClus" />
        </search:searchResultTypeInfo>
        <search:searchCriteriaTypeInfo>
           <ref bean="lu.criteria.all"/>
        </search:searchCriteriaTypeInfo>
    </search:searchType>

    <search:searchType id="lu.search.cluByCode">
        <search:name>Search for clu id by its code</search:name>
        <search:desc>Returns clu id</search:desc>
        <search:searchResultTypeInfo>
			<search:name>Lu id</search:name>
			<search:desc>Lu id</search:desc>        
        	<search:resultColumns>        
            	<ref bean="lu.resultColumn.cluId" />
        	</search:resultColumns>            
        </search:searchResultTypeInfo>
        <search:searchCriteriaTypeInfo>
           <ref bean="lu.criteria.code"/>
        </search:searchCriteriaTypeInfo>
    </search:searchType>

    <search:searchType id="lu.search.cluByCodeAndState">
		<search:name>Code and state match</search:name>
		<search:desc>Search by CLU Code and State.</search:desc>
		<search:searchResultTypeInfo>
			<ref bean="lu.result.cluQuickView" />
		</search:searchResultTypeInfo>
		<search:searchCriteriaTypeInfo>
			<ref bean="lu.criteria.cluByCodeAndState" />
		</search:searchCriteriaTypeInfo>
	</search:searchType>

    <search:searchResultTypeInfo id="lu.result.luClus">
        <search:name>Lu Clu</search:name>
        <search:desc>List Lu Clus</search:desc>
        <search:resultColumns>
            <ref bean="lu.resultColumn.cluId" />
            <ref bean="lu.resultColumn.cluOfficialIdentifier.longName" />
        </search:resultColumns>
    </search:searchResultTypeInfo>

    <search:searchResultTypeInfo id="lu.result.cluQuickView">
		<search:name>LU Quick View</search:name>
		<search:desc>Quick view of the CLU</search:desc>
		<search:resultColumns>
			<ref bean="lu.resultColumn.cluId" />
			<ref bean="lu.resultColumn.cluOfficialIdentifier.cluCode" />
		</search:resultColumns>
	</search:searchResultTypeInfo>

    <search:resultColumn id="lu.resultColumn.cluId">
        <search:name>Clu Id</search:name>
        <search:desc>Identifier of a Clu</search:desc>
        <search:dataType>string</search:dataType>
    </search:resultColumn>

    <search:resultColumn id="lu.resultColumn.cluOfficialIdentifier.longName">
        <search:name>Clu Long Name</search:name>
        <search:desc>Official identifier long name of a Clu</search:desc>
        <search:dataType>string</search:dataType>
    </search:resultColumn>

    <search:resultColumn id="lu.resultColumn.cluOfficialIdentifier.cluCode">
        <search:name>Clu Code</search:name>
        <search:desc>Official code of a Clu</search:desc>
        <search:dataType>string</search:dataType>
    </search:resultColumn>

    <search:queryParam id="lu.queryParam.cluState">
		<ref bean="childFieldDescriptor" />
	</search:queryParam>

    <search:queryParam id="lu.queryParam.cluCode">
		<dict:fieldDescriptor parent="childFieldDescriptor">
			<dict:name>Clu Code</dict:name>
		</dict:fieldDescriptor>
	</search:queryParam>

    <search:queryParam id="lu.queryParam.cluId">
		<dict:fieldDescriptor parent="childFieldDescriptor">
			<dict:name>Clu Id</dict:name>
		</dict:fieldDescriptor>
	</search:queryParam>

	<dict:fieldDescriptor id="parentFieldDescriptor">
		<dict:name>CLU Identifier</dict:name>
		<dict:desc>Unique identifier for a Canonical Learning Unit (CLU).</dict:desc>
		<dict:dataType>string</dict:dataType>
		<dict:readOnly>true</dict:readOnly>
	</dict:fieldDescriptor>
	
	<dict:fieldDescriptor id="childFieldDescriptor"
		parent="parentFieldDescriptor">
		<dict:name>Child CLU Identifier</dict:name>
	</dict:fieldDescriptor>
    
    <search:searchCriteriaTypeInfo id="lu.criteria.all">
        <search:name>LuClu</search:name>
        <search:desc>Placeholder Criteria</search:desc>
     </search:searchCriteriaTypeInfo>

    <search:searchCriteriaTypeInfo id="lu.criteria.code">
        <search:name>Code</search:name>
        <search:desc>Clu Code</search:desc>
     </search:searchCriteriaTypeInfo>

	<search:searchCriteriaTypeInfo id="lu.criteria.cluByCodeAndState">
		<search:name>LuByCodeAndStateCriteria</search:name>
		<search:desc>LuByCodeAndStateCriteria Description</search:desc>
		<search:queryParams>
			<ref bean="lu.queryParam.cluCode" />
			<ref bean="lu.queryParam.cluId" />
			<ref bean="lu.queryParam.cluState" />
		</search:queryParams>
	</search:searchCriteriaTypeInfo>

	<bean id="queryMap" class="org.springframework.beans.factory.config.MapFactoryBean">
		<property name="sourceMap">
			<map>
                <entry key="lu.search.clus">
                    <value>SELECT clu.id, clu.officialIdentifier.longName FROM Clu clu
                    	WHERE clu.state NOT IN ('draft') ORDER BY clu.officialIdentifier.longName </value>
                </entry>
                <entry key="lu.search.cluByCode">
                    <value>SELECT clu.id FROM Clu clu WHERE clu.officialIdentifier.code = :lu_criteria_code ORDER BY clu.effectiveDate DESC</value>
                </entry>
                <entry key="lu.search.cluByCodeAndState">
                    <value>SELECT clu.id, clu.officialIdentifier.code FROM Clu clu 
                    WHERE (clu.officialIdentifier.code like :lu_queryParam_cluCode 
                    or clu.id = :lu_queryParam_cluId)
                    and clu.state = :lu_queryParam_cluState
                    ORDER BY clu.officialIdentifier.code ASC</value>
                </entry>
                <entry key="lu.search.generic">
                    <value>SELECT clu.id,  clu.officialIdentifier.longName, clu.officialIdentifier.code, clu.officialIdentifier.level
                    		 FROM Clu clu WHERE clu.state NOT IN
                    		 ('draft') ORDER BY clu.officialIdentifier.longName</value>
                </entry>    
				<entry key="lu.queryParam.luOptionalId">
					<value>clu.id = :lu_queryParam_luOptionalId</value>
				</entry>
				<entry key="lu.queryParam.luOptionalType">
					<value>clu.luType.id = :lu_queryParam_luOptionalType</value>
				</entry>										
				<entry key="lu.queryParam.luOptionalLongName">
					<value>clu.officialIdentifier.longName</value>
				</entry>	
				<entry key="lu.queryParam.luOptionalCode">
					<value>clu.officialIdentifier.code</value>
				</entry>
				<entry key="lu.queryParam.luOptionalLevel">
					<value>clu.officialIdentifier.level</value>
				</entry>
            </map>
		</property>
	</bean>

</beans>
